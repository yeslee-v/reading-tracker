<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reading Tracker</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="logo">Reading Tracker</div>
      <div class="user-panel" id="userPanel">
        <div class="user-info" id="userInfo"></div>
        <div class="user-actions" id="userActions"></div>
      </div>
    </header>

    <main class="container">
      <section id="unauthenticated" class="panel hidden">
        <h2>로그인이 필요합니다</h2>
        <p>로그인하고 독서 기록을 관리해보세요.</p>
        <a class="button primary" href="/oauth2/authorization/naver">네이버 로그인</a>
      </section>

      <section id="appContent" class="hidden">
        <section class="panel summary-panel">
          <div class="panel-title">
            <h2>나의 독서 현황</h2>
          </div>
          <div class="summary-grid" id="stateSummary">
            <button
              class="summary-card active"
              data-role="state-button"
              data-state="IN_PROGRESS"
              type="button"
            >
              <span>읽는 중</span>
              <strong id="summaryInProgress">0</strong>
            </button>
            <button class="summary-card" data-role="state-button" data-state="COMPLETED" type="button">
              <span>완독</span>
              <strong id="summaryCompleted">0</strong>
            </button>
            <button class="summary-card" data-role="state-button" data-state="ARCHIVED" type="button">
              <span>보관</span>
              <strong id="summaryArchived">0</strong>
            </button>
          </div>
        </section>

        <section class="panel">
          <div class="panel-title">
            <h2>내 서재</h2>
            <button class="button primary" id="addBookBtn">도서 추가</button>
          </div>
          <div id="bookList" class="book-list"></div>
          <div id="emptyState" class="empty-state hidden">
            <p>해당 상태의 도서가 없습니다.</p>
          </div>
        </section>
      </section>
    </main>

    <div class="modal hidden" id="addBookModal">
      <div class="modal-content">
        <header>
          <h3>도서 추가</h3>
          <button class="icon-button" id="closeAddModalBtn">✕</button>
        </header>
        <div class="modal-body">
          <section class="search-box">
            <label for="searchInput">네이버 도서 검색</label>
            <div class="search-input-row">
              <input id="searchInput" type="text" placeholder="도서명 또는 저자를 입력하세요" />
              <button class="button secondary" id="searchBtn">검색</button>
            </div>
            <div id="searchResults" class="search-results"></div>
          </section>

          <section class="selected-book">
            <h4>선택한 도서</h4>
            <div id="selectedBookDetails" class="selected-book-details empty">
              <p>검색 결과에서 추가할 도서를 선택하세요.</p>
            </div>
            <label for="totalPagesInput">총 페이지</label>
            <input id="totalPagesInput" type="number" min="1" placeholder="예: 320" />
            <button class="button primary" id="submitAddBookBtn" disabled>내 서재에 추가</button>
          </section>
        </div>
      </div>
    </div>

    <div class="modal hidden" id="editBookModal">
      <div class="modal-content modal-edit">
        <header>
          <h3>도서 정보 수정</h3>
          <button class="icon-button" id="closeEditModalBtn">✕</button>
        </header>
        <div class="modal-body edit-modal-body">
          <div id="editBookInfo" class="selected-book-details empty">
            <p>수정할 도서를 선택하세요.</p>
          </div>
          <div class="edit-book-form">
            <div class="form-field">
              <label for="editCurrentPageInput">현재 페이지</label>
              <input id="editCurrentPageInput" type="number" min="1" placeholder="현재 페이지를 입력" />
            </div>
            <div class="form-field">
              <label for="editStateSelect">상태 변경</label>
              <select id="editStateSelect"></select>
            </div>
            <p class="input-hint">값이 하나라도 변경되어야 수정 버튼이 활성화됩니다.</p>
          </div>
        </div>
        <footer class="modal-footer">
          <button class="button primary" id="submitEditBookBtn" disabled>수정</button>
        </footer>
      </div>
    </div>

    <div class="modal hidden" id="nicknameModal">
      <div class="modal-content modal-edit">
        <header>
          <h3>닉네임 변경</h3>
          <button class="icon-button" id="closeNicknameModalBtn">✕</button>
        </header>
        <div class="modal-body edit-modal-body">
          <div class="form-field">
            <label for="nicknameInput">새 닉네임 (20자 이내)</label>
            <input id="nicknameInput" type="text" maxlength="20" placeholder="예: 북덕후" />
          </div>
        </div>
        <footer class="modal-footer">
          <button class="button primary" id="submitNicknameBtn" disabled>저장</button>
        </footer>
      </div>
    </div>

    <div id="toast" class="toast hidden"></div>

    <script src="/js/main.js" type="module"></script>
  </body>
</html>
